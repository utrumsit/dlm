#!/usr/bin/env bash
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
if [ -z "$DLM_LIBRARY_ROOT" ]; then export DLM_LIBRARY_ROOT="$(pwd)"; fi
HOSTNAME=$(hostname -s)
VENV_DIR="$SCRIPT_DIR/.venv_$HOSTNAME"
if [ ! -d "$VENV_DIR" ]; then
    echo "Initializing environment..."
    python3 -m venv "$VENV_DIR"
    "$VENV_DIR/bin/pip" install --upgrade pip
    if [ -f "$SCRIPT_DIR/requirements.txt" ]; then "$VENV_DIR/bin/pip" install -r "$SCRIPT_DIR/requirements.txt"; fi
fi
cd "$DLM_LIBRARY_ROOT"
"$VENV_DIR/bin/python3" "$SCRIPT_DIR/search_enhanced.py" "$@"
